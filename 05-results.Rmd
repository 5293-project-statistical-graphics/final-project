# Results

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.align = "center")
``` 

```{r}
library(lubridate)
library(tidyverse)
library(ggridges)
```
## issue
Issue is the key part where users and developers interact with each other. The number of issues can somewhat show the popularity of a package.
```{r}
issue <- read_csv("resources/data/issues.csv") %>% filter(year(created_at) >= 2014)
# issue per year
issue %>% 
  select(repo, author_association, created_at) %>%
  mutate(created_year=year(created_at) - 2000) %>%
  group_by(repo, author_association, created_year) %>%
  count(name = "number") %>%
  filter(created_year != 22)  %>%
  ggplot(aes(x = created_year, y = number, color = author_association)) +
  geom_line() +
  facet_wrap(~repo) +
  scale_x_continuous(breaks = 9:21) +
  labs(x = "created at (year)", y = "number of issues",
       title = "Number of issues created from 2014 to 2021")
```

```{r}
# issue per weekday
issue %>% 
  select(repo, created_at, author_association) %>%
  mutate(created_wday=wday(created_at, label = TRUE)) %>%
  group_by(repo, author_association, created_wday) %>%
  count(name="number") %>%
  ggplot(aes(x = created_wday, y = number)) +
  geom_col() +
  facet_grid(author_association~repo) +
  labs(x = "created at (weekday)", y = "number of issues",
       title = "Number of issues created per weekday")
```

issues that remains open, how long has passed since last update, how long has passed between created and last update
```{r}
open_issue <- issue %>% 
  select(created_at, updated_at, repo, state) %>%
  filter(state=="open") %>% 
  mutate(lastUpdateSinceCreated = interval(created_at, updated_at) / days(1),
         sinceLastUpdate = interval(created_at, now()) / days(1)) %>%
  pivot_longer(cols = c(lastUpdateSinceCreated, sinceLastUpdate), names_to = "category", values_to = "days")

ggplot(open_issue, aes(x=repo, y=days)) + 
  geom_boxplot() +
  facet_wrap(~category)

ggplot(open_issue, aes(x=days, y=repo)) +
  geom_density_ridges() +
  theme_ridges() +
  facet_wrap(~category)


```
issues that is closed tooks how long to solve, and is there any correlation between solve time and comments number
```{r}
issue %>% 
  select(created_at, updated_at, closed_at, repo, author_association, state) %>%
  filter(state=="closed") %>% 
  mutate(solveTime1 = interval(created_at, closed_at) / days(1),
         solveTime2 = interval(created_at, updated_at) / days(1)) %>%
  ggplot(aes(x = repo, y = solveTime2)) +
  geom_boxplot() +
  facet_wrap(~author_association)
```


```{r}
issue %>%
  group_by(repo, author_association) %>%
  count(name="number") %>%
  ggplot(aes(x = author_association, y = number, fill = repo)) +
  geom_col(position="dodge")
issue %>% 
  filter(state=="closed") %>%
  select(repo, comments, author_association) %>%
  filter(comments <= 15) %>%
  ggplot(aes(x = repo, y = comments)) +
  geom_boxplot() +
  facet_wrap(~author_association)
```


```{r}
issue %>% 
  select(repo, comments, author_association) %>%
  filter(comments < 15) %>%
  ggplot(aes(x = comments, y = repo, fill = stat(quantile))) +
  stat_density_ridges(quantile_lines = FALSE, calc_ecdf = TRUE, bandwidth = 1,
                      geom = "density_ridges_gradient") +
  facet_wrap(~author_association) +
  scale_fill_brewer(name = "quantile", labels = c("1st", "2nd", "3rd", "4th")) + 
  theme_ridges()
    
```

```{r}
pull <- read_csv("resources/data/pull_requests.csv") %>% filter(year(created_at) >= 2014)
pull %>% 
  select(repo, author_association, created_at) %>%
  mutate(created_year=year(created_at) - 2000) %>%
  group_by(repo, author_association, created_year) %>%
  count(name = "number") %>%
  filter(created_year != 22)  %>%
  ggplot(aes(x = created_year, y = number, color = author_association)) +
  geom_line() +
  facet_wrap(~repo) +
  scale_x_continuous(breaks = 9:21) +
  labs(x = "created at (year)", y = "number of pull requests",
       title = "Number of pull requests created from 2014 to 2021")
```

